var searchForm=document.querySelector(".search-form"),formOpenBtn=document.querySelector(".hotel-search__button"),formInputCheckIn=searchForm.querySelector("#check-in-date"),formAdults=searchForm.querySelector("#adults"),formChilds=searchForm.querySelector("#childs"),formSubmit=searchForm.querySelector(".search-form__submit-btn"),fields=searchForm.querySelectorAll(".input"),keys={Tab:9,Esc:27},clearStatus=function(){for(var e=0;e<fields.length;e++)fields[e].classList.contains("input--error")&&fields[e].classList.remove("input--error"),fields[e].hasAttribute("aria-invalid")&&fields[e].removeAttribute("aria-invalid")};function QuantityObj(e){this.section=e,this.field=e.querySelector(".search-form__input-num"),this.btnMinus=e.querySelector(".search-form__counter-btn--minus"),this.btnPlus=e.querySelector(".search-form__counter-btn--plus"),this.minQuantity=+this.field.getAttribute("min"),addQuantitySectionHandler(this),addQuantityFieldHandler(this)}formOpenBtn.addEventListener("click",function(e){e.preventDefault(),clearStatus(),!searchForm.classList.contains("search-form--closed")&&!searchForm.classList.contains("search-form--opened")||searchForm.classList.contains("search-form--closed")?(searchForm.classList.remove("search-form--closed"),searchForm.offsetWidth=searchForm.offsetWidth,searchForm.classList.add("search-form--opened"),formOpenBtn.setAttribute("aria-label","Закрыть форму поиска гостиниц"),setTimeout(function(){fields[0].focus()},600),window.addEventListener("keydown",function(e){e.keyCode===keys.Esc&&(e.preventDefault(),searchForm.classList.remove("search-form--opened"),searchForm.offsetWidth=searchForm.offsetWidth,searchForm.classList.add("search-form--closed"),formOpenBtn.setAttribute("aria-label","Открыть форму поиска гостиниц"),formOpenBtn.focus())}),formOpenBtn.addEventListener("keydown",function(e){e.keyCode===keys.Tab&&e.shiftKey&&searchForm.classList.contains("search-form--opened")&&(e.preventDefault(),formSubmit.focus())}),formSubmit.addEventListener("keydown",function(e){e.keyCode!==keys.Tab||e.shiftKey||(e.preventDefault(),formOpenBtn.focus())})):(searchForm.classList.remove("search-form--opened"),searchForm.offsetWidth=searchForm.offsetWidth,searchForm.classList.add("search-form--closed"),formOpenBtn.setAttribute("aria-label","Открыть форму поиска гостиниц"))}),formOpenBtn.addEventListener("mouseup",function(e){this.blur()}),searchForm.addEventListener("submit",function(e){clearStatus();for(var t=0;t<fields.length;t++)if(!fields[t].value)return e.preventDefault(),fields[t].offsetWidth=fields[t].offsetWidth,fields[t].classList.add("input--error"),fields[t].setAttribute("aria-invalid","true"),void fields[t].focus()});var timer,addQuantitySectionHandler=function(r){r.section.addEventListener("click",function(e){for(var t=e.target;!t.classList.contains("search-form__item");){if("BUTTON"===t.tagName&&(t===r.btnPlus&&(r.field.value=+r.field.value+1),t===r.btnMinus)){if(+r.field.value===r.minQuantity)return;r.field.value=+r.field.value-1}t=t.parentNode}}),r.btnMinus.addEventListener("mouseup",function(e){this.blur()}),r.btnPlus.addEventListener("mouseup",function(e){this.blur()})},addQuantityFieldHandler=function(t){t.field.addEventListener("change",function(){var e=Math.round(+t.field.value);e<t.minQuantity&&(e=t.minQuantity),t.field.value=e})},adultsObj=new QuantityObj(searchForm.querySelector(".adults-quantity")),childsObj=new QuantityObj(searchForm.querySelector(".childs-quantity")),sliderContainer=document.querySelector(".greeting"),slider=sliderContainer.querySelector(".greeting__slider"),prevBtn=sliderContainer.querySelector(".greeting__slider-btn--prev"),nextBtn=sliderContainer.querySelector(".greeting__slider-btn--next"),playBtn=sliderContainer.querySelector(".greeting__slider-btn--play"),controlBtns=sliderContainer.querySelectorAll(".greeting__slider-btn"),slidesCol=slider.querySelectorAll(".greeting__slide"),slidesArr=Array.prototype.slice.call(slidesCol,0),currentSlide=slidesArr[0],currentSlideIndex=0,isSlideShowPaused=!1,directions={next:function(){currentSlideIndex++},prev:function(){currentSlideIndex--}},setSlide=function(e){e(),currentSlideIndex===slidesArr.length?currentSlideIndex=0:currentSlideIndex<0&&(currentSlideIndex=slidesArr.length-1),currentSlide.classList.remove("greeting__slide--current"),(currentSlide=slidesArr[currentSlideIndex]).classList.add("greeting__slide--current")},startTimer=function(){timer=setInterval(function(){setSlide(directions.next)},7e3)},stopShow=function(){clearInterval(timer),playBtn.classList.remove("greeting__slider-btn--play--pause"),playBtn.setAttribute("aria-label","Возобновить слайд-шоу"),isSlideShowPaused=!0},playShow=function(){startTimer(),playBtn.classList.add("greeting__slider-btn--play--pause"),playBtn.setAttribute("aria-label","Остановить слайд-шоу"),isSlideShowPaused=!1,setSlide(directions.next)};sliderContainer.addEventListener("click",function(e){e.target!==nextBtn&&e.target!==prevBtn||(isSlideShowPaused||stopShow(),e.target===nextBtn?setSlide(directions.next):e.target===prevBtn&&setSlide(directions.prev)),e.target===playBtn&&(isSlideShowPaused?playShow():stopShow())});for(var i=0;i<controlBtns.length;i++)controlBtns[i].addEventListener("mouseup",function(e){this.blur()});startTimer();
